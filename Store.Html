<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TradeVerse Store</title>
<script src="https://cdn.tailwindcss.com"></script>
<!-- PayPal SDK: replace sb with your live client ID for real payments -->
<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=ZAR"></script>
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">

<!-- Header -->
<header class="sticky top-0 z-20 backdrop-blur bg-white/70 border-b border-slate-200">
  <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
    ğŸ›ï¸
    <h1 class="text-xl font-semibold tracking-tight">TradeVerse</h1>
    <div class="ml-auto flex items-center gap-3">
      <input id="searchInput" placeholder="Search productsâ€¦" class="rounded-2xl border border-slate-300 pl-3 pr-3 py-2"/>
      <button id="openCartBtn" class="rounded-2xl px-3 py-2 border border-slate-300 hover:bg-slate-50 inline-flex items-center gap-2">
        ğŸ›’ Cart
      </button>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-6 flex-1">
  <!-- Categories -->
  <div class="flex gap-2 mb-4 overflow-auto" id="categoryContainer"></div>
  <!-- Product Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="productGrid"></div>
</main>

<!-- Cart Modal -->
<div id="cartModal" class="fixed inset-0 z-40 hidden items-center justify-center bg-black/20">
  <div class="relative w-full max-w-md bg-white shadow-2xl border border-slate-200 rounded-2xl p-4">
    <div class="flex items-center gap-3 mb-3">
      ğŸ›’ <h2 class="text-lg font-semibold">Your Cart</h2>
      <button id="closeCart" class="ml-auto p-2 hover:bg-slate-100 rounded-full">âœ–ï¸</button>
    </div>
    <div id="cartItems" class="flex flex-col gap-3 max-h-80 overflow-auto"></div>
    <div class="mt-3 space-y-2 border-t border-slate-200 pt-2">
      <div class="flex justify-between text-sm"><span>Subtotal</span><span id="subtotal">R0.00</span></div>
      <div class="flex justify-between text-sm"><span>Shipping</span><span id="shipping">R0.00</span></div>
      <div class="flex justify-between font-semibold text-base"><span>Total</span><span id="total">R0.00</span></div>
      <!-- PayPal Button -->
      <div id="paypal-button-container" class="mt-3"></div>
    </div>
  </div>
</div>

<!-- Toast Notification -->
<div id="toast" class="fixed bottom-4 right-4 bg-black text-white px-4 py-2 rounded-lg shadow-lg opacity-0 transition-opacity"></div>

<script>
const CATALOGUE = [
  {id:"vr-01",name:"Nebula VR Headset",price:4999,stock:12,category:"Hardware",image:"https://images.unsplash.com/photo-1581276879432-15e50529f34b?q=80&w=1600&auto=format&fit=crop"},
  {id:"pad-02",name:"TradeVerse HoloPad",price:3299,stock:8,category:"Hardware",image:"https://images.unsplash.com/photo-1526498460520-4c246339dccb?q=80&w=1600&auto=format&fit=crop"},
  {id:"sub-03",name:"Creator Plus (12 mo)",price:1499,stock:999,category:"Subscription",image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?q=80&w=1600&auto=format&fit=crop"},
  {id:"acc-04",name:"Quantum Cables (3-pack)",price:299,stock:37,category:"Accessories",image:"https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1600&auto=format&fit=crop"},
  {id:"sw-05",name:"TradeVerse Studio (Lifetime)",price:5999,stock:50,category:"Software",image:"https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1600&auto=format&fit=crop"}
];

let cart = [];

// Save & Load Cart from localStorage
function saveCart() { localStorage.setItem("tradeverseCart", JSON.stringify(cart)); }
function loadCart() { const saved = localStorage.getItem("tradeverseCart"); if(saved) cart = JSON.parse(saved); }

// Currency formatter
function ZAR(cents){ return new Intl.NumberFormat("en-ZA",{style:"currency",currency:"ZAR"}).format(cents/100); }

// Toast
function showToast(msg){
  const toast=document.getElementById("toast");
  toast.textContent=msg;
  toast.classList.remove("opacity-0");
  toast.classList.add("opacity-100");
  setTimeout(()=>{toast.classList.remove("opacity-100"); toast.classList.add("opacity-0");},2000);
}

// Update cart display
function updateCartDisplay(){
  const cartItemsDiv=document.getElementById("cartItems");
  const subtotalDiv=document.getElementById("subtotal");
  const shippingDiv=document.getElementById("shipping");
  const totalDiv=document.getElementById("total");
  cartItemsDiv.innerHTML="";
  let subtotal=0;
  cart.forEach(p=>{
    subtotal+=p.price*p.qty;
    const div=document.createElement("div");
    div.className="flex justify-between items-center gap-2 border border-slate-200 p-2 rounded-xl";
    div.innerHTML=`<span>${p.qty}x ${p.name}</span>
      <div class="flex items-center gap-1">
        <input type="number" min="1" max="99" value="${p.qty}" style="width:50px" />
        <button class="text-red-600 font-bold">âœ–ï¸</button>
      </div>`;
    div.querySelector("input").addEventListener("change",(e)=>{
      p.qty=Math.max(1,Math.min(99,parseInt(e.target.value)||1));
      updateCartDisplay();
    });
    div.querySelector("button").addEventListener("click",()=>{cart=cart.filter(c=>c.id!==p.id);updateCartDisplay();});
    cartItemsDiv.appendChild(div);
  });
  const shipping=subtotal>5000||cart.length===0?0:690;
  subtotalDiv.textContent=ZAR(subtotal);
  shippingDiv.textContent=shipping===0?"Free":ZAR(shipping);
  totalDiv.textContent=ZAR(subtotal+shipping);

  saveCart();
  renderPayPalButton(subtotal+shipping);
}

// PayPal Button
function renderPayPalButton(total){
  const container=document.getElementById("paypal-button-container");
  container.innerHTML="";
  if(cart.length===0) return;

  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: { value:(total/100).toFixed(2), currency_code:"ZAR" },
          description: "Your purchase from TradeVerse"
        }]
      });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
        showToast("âœ… Payment Successful");
        cart = [];
        updateCartDisplay();
      });
    },
    onError: function(err){ alert("Payment failed: "+err); }
  }).render("#paypal-button-container");
}

// Open/close cart modal
document.getElementById("openCartBtn").addEventListener("click",()=>{document.getElementById("cartModal").classList.remove("hidden");});
document.getElementById("closeCart").addEventListener("click",()=>{document.getElementById("cartModal").classList.add("hidden");});

// Render categories
const productGrid=document.getElementById("productGrid");
const categoryContainer=document.getElementById("categoryContainer");
let currentCategory="All";
const categories=["All",...new Set(CATALOGUE.map(p=>p.category))];
categories.forEach(cat=>{
  const btn=document.createElement("button");
  btn.textContent=cat;
  btn.className="rounded-full px-3 py-1.5 border border-slate-300 hover:bg-slate-50";
  btn.addEventListener("click",()=>{currentCategory=cat;renderProducts();});
  categoryContainer.appendChild(btn);
});

// Render products
function renderProducts(){
  const q=document.getElementById("searchInput").value.toLowerCase();
  productGrid.innerHTML="";
  const filtered=CATALOGUE.filter(p=>{
    const inCat=currentCategory==="All"||p.category===currentCategory;
    const inQ=q===""||p.name.toLowerCase().includes(q)||p.category.toLowerCase().includes(q);
    return inCat&&inQ;
  });
  filtered.forEach(p=>{
    const card=document.createElement("div");
    card.className="rounded-2xl border border-slate-200 overflow-hidden shadow-sm bg-white flex flex-col";
    card.innerHTML=`
      <img src="${p.image}" alt="${p.name}" class="w-full h-40 object-cover"/>
      <div class="p-3 flex-1 flex flex-col justify-between">
        <div>
          <div class="font-semibold">${p.name}</div>
          <div class="text-sm text-slate-500">${p.category}</div>
          <div class="text-sm text-slate-600">${p.stock} in stock</div>
        </div>
        <button class="mt-2 rounded-xl px-3 py-2 bg-black text-white hover:bg-slate-800">Add to Cart</button>
      </div>
    `;
    card.querySelector("button").addEventListener("click",()=>{
      const existing=cart.find(c=>c.id===p.id);
      if(existing){existing.qty=Math.min(existing.qty+1,99);}
      else cart.push({...p,qty:1});
      updateCartDisplay();
      showToast("âœ… Added to cart");
    });
    productGrid.appendChild(card);
  });
}

// Search input listener
document.getElementById("searchInput").addEventListener("input", renderProducts);

// Load cart and render everything on page load
loadCart();
renderProducts();
updateCartDisplay();
</script>
</body>
</html>
